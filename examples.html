<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Camcloud API Examples</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    /* ——— layout (unchanged) ——— */
    body{margin:0;font:16px/1.55 "Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto}
    nav{background:#152534;padding:1rem 1.5rem;display:flex;gap:1rem;align-items:center}
    nav img{height:64px}
    main{max-width:960px;margin:2.5rem auto;padding:0 1rem}
    h1{font-size:2.25rem;margin-bottom:1.25rem}
    h2{font-size:1.45rem;margin:2.25rem 0 1rem;color:#29b6f6}
    article{border-bottom:1px solid #304357;padding-bottom:2.5rem}
    /* ——— code switcher ——— */
    .code-sample{border:1px solid #304357;border-radius:6px;margin-top:.6rem}
    .code-toolbar{display:flex;justify-content:space-between;background:#1e2735;
                  padding:.35rem .6rem}
    .lang-btn{background:none;border:none;font-size:1.2rem;color:#c9d1d9;
              margin-right:.45rem;cursor:pointer;opacity:.55}
    .lang-btn.active{opacity:1}
    .copy-btn{background:none;border:none;color:#c9d1d9;font-size:1.05rem;cursor:pointer}
    pre{margin:0;background:#0d1117;color:#c9d1d9;padding:1rem;overflow-x:auto;font-size:.88rem}
    pre.hidden{display:none}
    code{font-family:Consolas,monaco,monospace}
  </style>
</head>
<body>

<nav>
  <img src="images/camcloud.png" alt="Camcloud logo">
  <!-- nav links omitted for brevity -->
</nav>

<main>
  <h1>Practical API Examples</h1>

  <!-- 1 ── Discover account context ─────────────────────────────── -->
  <article id="authorize">
    <h2>1&nbsp;·&nbsp;Discover your account context <small>/v1/authorizeV2</small></h2>
    <div class="code-sample">
      <div class="code-toolbar">
        <div>
          <button class="lang-btn active" data-lang="python"><i class="fa-brands fa-python"></i></button>
          <button class="lang-btn" data-lang="php"><i class="fa-brands fa-php"></i></button>
          <button class="lang-btn" data-lang="shell"><i class="fa-solid fa-terminal"></i></button>
        </div>
        <button class="copy-btn"><i class="fa-regular fa-copy"></i></button>
      </div>

      <pre data-lang="python"><code>import os, requests, pprint
BASE = "https://api.hostedcloudvideo.com"
r = requests.get(f"{BASE}/v1/authorizeV2",
                 headers={"Authorization": f"Bearer {os.environ['API_KEY']}"})
pprint.pp(r.json())</code></pre>

      <pre data-lang="php" class="hidden"><code>&lt;?php
$base='https://api.hostedcloudvideo.com';
$api=getenv('API_KEY');
$ch=curl_init("$base/v1/authorizeV2");
curl_setopt_array($ch,[CURLOPT_HTTPHEADER=>["Authorization: Bearer $api"],
                      CURLOPT_RETURNTRANSFER=>true]);
print_r(json_decode(curl_exec($ch),true));</code></pre>

      <pre data-lang="shell" class="hidden"><code>curl -H "Authorization: Bearer &lt;API_KEY&gt;" \
  https://api.hostedcloudvideo.com/v1/authorizeV2</code></pre>
    </div>
  </article>

  <!-- 2 ── List cameras ─────────────────────────────────────────── -->
  <article id="list-cams">
    <h2>2&nbsp;·&nbsp;List all cameras <small>/v1/accounts/{accountId}/cameras</small></h2>
    <!-- same switcher structure … (omitted for brevity) -->
  </article>

  <!-- 3 ── Health history ───────────────────────────────────────── -->
  <article id="health-history">
    <h2>3&nbsp;·&nbsp;Health history for cameras <small>/v1/accounts/{accountId}/health-history</small></h2>
    <p style="margin:.3rem 0 .6rem;color:#adb5bd">
      Returns every state-change for the account’s cameras – great for dashboards or reports.:contentReference[oaicite:5]{index=5}
    </p>
    <div class="code-sample">
      <div class="code-toolbar">
        <div>
          <button class="lang-btn active" data-lang="python"><i class="fa-brands fa-python"></i></button>
          <button class="lang-btn" data-lang="php"><i class="fa-brands fa-php"></i></button>
          <button class="lang-btn" data-lang="shell"><i class="fa-solid fa-terminal"></i></button>
        </div><button class="copy-btn"><i class="fa-regular fa-copy"></i></button>
      </div>

      <pre data-lang="python"><code>import os, requests, json, datetime as dt
BASE  = "https://api.hostedcloudvideo.com"
ACCT  = "&lt;ACCOUNT_ID&gt;"
since = (dt.datetime.utcnow()-dt.timedelta(days=1)).isoformat()+"Z"
url   = f"{BASE}/v1/accounts/{ACCT}/health-history?cursor=&cameraIds=&start={since}"
r = requests.get(url,headers={"Authorization":f"Bearer {os.environ['API_KEY']}"})
print(json.dumps(r.json(),indent=2))</code></pre>

      <pre data-lang="php" class="hidden"><code>&lt;?php
$base='https://api.hostedcloudvideo.com'; $acct='&lt;ACCOUNT_ID&gt;';
$api=getenv('API_KEY'); $since=urlencode(gmdate('c',time()-86400));
$ch=curl_init("$base/v1/accounts/$acct/health-history?start=$since");
curl_setopt_array($ch,[CURLOPT_HTTPHEADER=>["Authorization: Bearer $api"],
                      CURLOPT_RETURNTRANSFER=>true]);
echo curl_exec($ch);</code></pre>

      <pre data-lang="shell" class="hidden"><code>curl -H "Authorization: Bearer &lt;API_KEY&gt;" \
  "https://api.hostedcloudvideo.com/v1/accounts/&lt;ACCOUNT_ID&gt;/health-history?start=$(date -u -Iseconds -d '1 day ago')" </code></pre>
    </div>
  </article>

  <!-- 4 ── Update camera ─────────────────────────────────────────── -->
  <article id="update-camera">
    <h2>4&nbsp;·&nbsp;Update a camera <small>/v1/cameras/{cameraId}</small></h2>
    <!-- switcher identical to earlier answer (omitted) -->
  </article>

  <!-- 5 ── Snapshots for a range ─────────────────────────────────── -->
  <article id="snapshots">
    <h2>5&nbsp;·&nbsp;Retrieve snapshots for a timeframe <small>/v1/cameras/{cameraId}/snapshot</small></h2>
    <p style="margin:.3rem 0 .6rem;color:#adb5bd">
      The API delivers one image per request. Loop over your time-range or call
      <code>/snapshot?time=ISO-8601</code>; below is a quick helper that fetches hourly stills.
      (See also <code>/carousel</code> for stitched-together strips.):contentReference[oaicite:7]{index=7}
    </p>
    <div class="code-sample">
      <div class="code-toolbar">
        <div>
          <button class="lang-btn active" data-lang="python"><i class="fa-brands fa-python"></i></button>
          <button class="lang-btn" data-lang="php"><i class="fa-brands fa-php"></i></button>
          <button class="lang-btn" data-lang="shell"><i class="fa-solid fa-terminal"></i></button>
        </div><button class="copy-btn"><i class="fa-regular fa-copy"></i></button>
      </div>

      <pre data-lang="python"><code>import os, requests, datetime as dt, pathlib
BASE, CAM = "https://api.hostedcloudvideo.com", "&lt;CAMERA_ID&gt;"
headers   = {"Authorization":f"Bearer {os.environ['API_KEY']}"}

start = dt.datetime(2025,5,1,8)      # 08:00 UTC
end   = dt.datetime(2025,5,1,18)     # 18:00 UTC

t = start
while t &lt;= end:
    ts  = t.isoformat()+"Z"
    url = f"{BASE}/v1/cameras/{CAM}/snapshot?time={ts}"
    jpg = requests.get(url,headers=headers).content
    pathlib.Path(f"snapshot_{ts}.jpg").write_bytes(jpg)
    t += dt.timedelta(hours=1)</code></pre>

      <pre data-lang="php" class="hidden"><code>&lt;?php
$base='https://api.hostedcloudvideo.com'; $cam='&lt;CAMERA_ID&gt;';
$api=getenv('API_KEY');
for($t=strtotime('2025-05-01 08:00 UTC');$t&lt;=strtotime('2025-05-01 18:00 UTC');$t+=3600){
  $ts=urlencode(gmdate('c',$t));
  $ch=curl_init("$base/v1/cameras/$cam/snapshot?time=$ts");
  curl_setopt_array($ch,[CURLOPT_HTTPHEADER=>["Authorization: Bearer $api"],
                        CURLOPT_RETURNTRANSFER=>true]);
  file_put_contents("snapshot_$ts.jpg",curl_exec($ch));
  curl_close($ch);
}</code></pre>

      <pre data-lang="shell" class="hidden"><code># single image
curl -H "Authorization: Bearer &lt;API_KEY&gt;" \
  "https://api.hostedcloudvideo.com/v1/cameras/&lt;CAMERA_ID&gt;/snapshot?time=2025-05-01T12:00:00Z" \
  -o noon.jpg</code></pre>
    </div>
  </article>

  <!-- 6 ── Upload custom events ─────────────────────────────────── -->
  <article id="custom-events">
    <h2>6&nbsp;·&nbsp;Upload custom events <small>/notify/custom/{cameraId}</small></h2>
    <p style="margin:.3rem 0 .6rem;color:#adb5bd">
      POST to the <em>Upload&nbsp;API</em> with up to five custom events per request.  
      The body must follow <code>EventCreateDataDtoV3</code> – example below is lifted from
      the spec.:contentReference[oaicite:9]{index=9}
    </p>
    <div class="code-sample">
      <div class="code-toolbar">
        <div>
          <button class="lang-btn active" data-lang="python"><i class="fa-brands fa-python"></i></button>
          <button class="lang-btn" data-lang="php"><i class="fa-brands fa-php"></i></button>
          <button class="lang-btn" data-lang="shell"><i class="fa-solid fa-terminal"></i></button>
        </div><button class="copy-btn"><i class="fa-regular fa-copy"></i></button>
      </div>

      <pre data-lang="python"><code>import os, requests, json, datetime as dt
UP  = "https://upload.hostedcloudvideo.com"
CAM = "&lt;CAMERA_ID&gt;"
API = os.environ['API_KEY']

payload = {
  "start": dt.datetime.utcnow().isoformat()+"Z",
  "end":   (dt.datetime.utcnow()+dt.timedelta(seconds=10)).isoformat()+"Z",
  "types": {
    "custom": [{
      "types":  ["pointOfSale"],
      "actions":["Paid","Refund"],
      "boundingBox":{"width":100,"height":200,"left":300,"top":400},
      "freeformAttributes":{"storeId":"789","city":"Tampa Bay"}
    }]
  }
}

r = requests.post(f"{UP}/notify/custom/{CAM}",
                  headers={"Authorization":f"Bearer {API}",
                           "Content-Type":"application/json"},
                  json=payload)
print(r.status_code,r.text)</code></pre>

      <pre data-lang="php" class="hidden"><code>&lt;?php
$up='https://upload.hostedcloudvideo.com'; $cam='&lt;CAMERA_ID&gt;';
$api=getenv('API_KEY');
$payload=[
  "start"=>gmdate('c'),
  "end"=>gmdate('c',time()+10),
  "types"=>["custom"=>[[
    "types"=>["pointOfSale"],
    "actions"=>["Paid","Refund"],
    "boundingBox"=>["width"=>100,"height"=>200,"left"=>300,"top"=>400],
    "freeformAttributes"=>["storeId"=>"789","city"=>"Tampa Bay"]
  ]]]
];
$ch=curl_init("$up/notify/custom/$cam");
curl_setopt_array($ch,[CURLOPT_HTTPHEADER=>[
                        "Authorization: Bearer $api",
                        "Content-Type: application/json"],
                      CURLOPT_POST=>true,
                      CURLOPT_POSTFIELDS=>json_encode($payload),
                      CURLOPT_RETURNTRANSFER=>true]);
echo curl_exec($ch);</code></pre>

      <pre data-lang="shell" class="hidden"><code>curl -X POST \
  -H "Authorization: Bearer &lt;API_KEY&gt;" \
  -H "Content-Type: application/json" \
  -d @payload.json \
  https://upload.hostedcloudvideo.com/notify/custom/&lt;CAMERA_ID&gt;</code></pre>
    </div>
  </article>

  <p style="margin-top:3rem">
    Looking for something else? The full OpenAPI specs are available at
    <code>https://api.hostedcloudvideo.com</code> and
    <code>https://upload.hostedcloudvideo.com</code>.
  </p>
</main>

<script>
/* language switcher + copy button – re-usable */
document.querySelectorAll('.code-sample').forEach(sample=>{
  const buttons=sample.querySelectorAll('.lang-btn');
  const pres   =sample.querySelectorAll('pre');
  buttons.forEach(btn=>btn.addEventListener('click',()=>{
    const lang=btn.dataset.lang;
    buttons.forEach(b=>b.classList.toggle('active',b===btn));
    pres.forEach(p=>p.classList.toggle('hidden',p.dataset.lang!==lang));
  }));
  sample.querySelector('.copy-btn').addEventListener('click',()=>{
    const code=sample.querySelector('pre:not(.hidden) code').innerText;
    navigator.clipboard.writeText(code)
      .then(()=>sample.querySelector('.copy-btn i')
                    .classList.replace('fa-copy','fa-check'))
      .finally(()=>setTimeout(()=>sample.querySelector('.copy-btn i')
                                     .classList.replace('fa-check','fa-copy'),1200));
  });
});
</script>
</body>
</html>
